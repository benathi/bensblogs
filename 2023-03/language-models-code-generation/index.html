<!DOCTYPE html>
<!-- _layouts/distill.html --><html>
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Unreasonable Effectiveness of LLMs for Code Generation | AI Bytes</title>
    <meta name="author" content="Ben  Athiwaratkun">
    <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design.
">
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website">


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700%7CRoboto+Slab:100,300,400,500,700%7CMaterial+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light">

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%92%A1&lt;/text&gt;&lt;/svg&gt;">
    
    <link rel="stylesheet" href="/blogs/assets/css/main.css">
    <link rel="canonical" href="https://benathi.github.io/blogs/2023-03/language-models-code-generation/">
    
    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark">

    <script src="/blogs/assets/js/theme.js"></script>
    <script src="/blogs/assets/js/dark_mode.js"></script>
    


    <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-53653308-1', 'auto');
    ga('require', 'displayfeatures');
    ga('send', 'pageview');
  </script>

    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams',
        "HTML-CSS": {
          styles: {
            ".MathJax_Display": {
              "font-size": "80%"
            }
          }
        }
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <!-- Distill js -->
    <!-- the culprit for code highlight is template.v2.js -->
    <script src="/blogs/assets/js/distillpub/template.v2.js"></script>
    <script src="/blogs/assets/js/distillpub/transforms.v2.js"></script>
    <script src="/blogs/assets/js/distillpub/overrides.js"></script>
    
    <!-- Page/Post style -->
    <style type="text/css">
      .fake-img {
  background: #bbb;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 0px 4px rgba(0, 0, 0, 0.1);
  margin-bottom: 12px;
} .fake-img p {
  font-family: monospace;
  color: white;
  text-align: left;
  margin: 12px 0;
  text-align: center;
  font-size: 16px;

    </style>

  </head>

  <body>
<d-front-matter>
    <script async type="text/json">{
      "title": "Unreasonable Effectiveness of LLMs for Code Generation",
      "description": "",
      "published": "March 7, 2023",
      "authors": [
        {
          "author": "Ben Athiwaratkun",
          "authorURL": "https://benathi.github.io",
          "affiliations": [
            {
              "name": "",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script>
  </d-front-matter>

  

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <!--
          Insert link back to main page here
          -->
          <a class="navbar-brand title font-weight-lighter" href="https://benathi.github.io/" target="_self">
              Ben's
          </a>

          <a class="navbar-brand title font-weight-lighter" href="/blogs/">AI Bytes</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/blogs/"></a>
              </li>
              

              <!-- Other pages -->

              <!-- Toogle theme mode -->
              <li class="toggle-container">
                <button id="light-toggle" title="Change theme">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </button>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- Scrolling Progress Bar -->
      <progress id="progress" value="0">
        <div class="progress-container">
          <span class="progress-bar"></span>
        </div>
      </progress>
    </header>


    <!-- Content -->
    <div class="post distill">

      <d-title>
        <h1>Unreasonable Effectiveness of LLMs for Code Generation</h1>
        <p></p>
      </d-title>

      <d-byline></d-byline>

      <d-article>
        <d-contents>
          <nav class="l-text figcaption">
          <h3>Contents</h3>
            <div><a href="#out-of-domain-generalization">Out of Domain Generalization</a></div>
            <div><a href="#natural-co-occurrences-of-multi-lingual-knowledge">Natural Co-Occurrences of Multi-lingual Knowledge</a></div>
            <div><a href="#multi-ligual-versus-mono-lingual">Multi-ligual versus Mono-lingual</a></div>
            <div><a href="#"></a></div>
            <div><a href="#zero-shot-translation">Zero-Shot Translation</a></div>
            <div><a href="#few-shot-prompts-helps-llms-on-out-of-domain-languages">Few-Shot Prompts Helps LLMs on Out-of-Domain Languages</a></div>
            
          </nav>
        </d-contents>

        <p>At this point, we are no longer surprised about what language models can do.
However, it is still unclear how language models derive such amazing abilities especially in the area of code generation. This blog discusses the highlights from the paper <a href="https://arxiv.org/pdf/2210.14868.pdf" rel="external nofollow noopener" target="_blank">Multilingual Evaluation of Code Generation Models</a> which give some clue as to how LLMs are so great at coding.</p>

<h2 id="out-of-domain-generalization">Out of Domain Generalization</h2>
<p>If we train a model on one programming language, it turns out that such a model can also <strong>write code in different programming languages</strong>, especially when the model is large enough!  Letâ€™s look at the results and sample generations.</p>

<p>Here, we train a decoder model on three languages: Python, Java, JavaScript. We use the model to sample and generate many versions of code and evaluate with the pass@k metric (one can think of it as accuracies given k chances). The result in Figure 1 shows that not only does it perform well on all languages that are trained on, the model also performs well on unseen languages (PHP, Ruby, Kotlin). How is this possible?</p>

<div class="col-sm mt-3 mt-md-0">
<figure style="background-color: white;">

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/blogs/assets/img/blogs/mbxp/sampling-mbxp-4.svg" class="img-fluid rounded z-depth-1" width="auto" height="auto" style="padding: 0px;" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="caption">Figure 1: pass@k scores (accuracy) versus sampling budget k</figcaption>

</figure>

</div>

<h2 id="natural-co-occurrences-of-multi-lingual-knowledge">Natural Co-Occurrences of Multi-lingual Knowledge</h2>
<p>It turns out that the natural occurrences of code data are quite common. Take the following code for example, which is a Python code that has JavaScript wrapped as a string.
This piece of data counts as Python data since it parses the Python interpreter, as well as being from a <code class="language-plaintext highlighter-rouge">.py</code> file. We refer to such multi-lingual occurrences of programming languages as <strong>knowledge spillver</strong>. Such spillover explains why training language models on Python yields a model that can write JavaScript.</p>

<p>The previous result shows the generalization of multi-lingual model trained on three languages. Mono-lingual models can also generalize.</p>

<div class="col-sm mt-3 mt-md-0">
<figure style="background-color: white;">

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/blogs/assets/img/blogs/mbxp/example-python-js-snippet.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" style="padding: 0px;" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="caption">Figure 2: JavaScript as a Python string representing cross-programming-language knowledge spillover.</figcaption>

</figure>

</div>

<h2 id="multi-ligual-versus-mono-lingual">Multi-ligual versus Mono-lingual</h2>

<div class="col-sm mt-3 mt-md-0">
<figure style="background-color: white;">

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/blogs/assets/img/blogs/mbxp/trend_vs_size_datasetall_mode-large_scale_temp0.6_passat10_grid0.svg" class="img-fluid rounded z-depth-1" width="auto" height="auto" style="padding: 0px;" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="caption">Figure 3: pass@k scores (accuracy) versus model size</figcaption>

</figure>

</div>

<p>Figure 2 represents the results including results comparing multi- and mono-lingual models. There are a lot going on, but letâ€™s break it down.</p>

<ul>
  <li>We observe that the Python model (pink) has high accuracy in Java and JavaScript evaluation, which makes sense according to the hypothesis that models can pick up knowledge of other languages embedded in the primary languageâ€™s code.</li>
  <li>The Java model (blue) and JavaScript model (green) seem to perform quite poorly on Python. We believe it is likely due to the lack of Python knowledge in Java/JavaScript data.</li>
  <li>In the multi-lingual model where we train on Python, Java, JS, we observe the Python performance being very similar to the mono-lingual Python performance. This seems to confirm the above point that thereâ€™s little Java/JS knowledge in Python data, which means that in the multi-ligual case, the Python performance will be close to that of the mono-lingual Python model.</li>
</ul>

<div class="col-sm mt-3 mt-md-0">
<figure style="background-color: white;">

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/blogs/assets/img/blogs/mbxp/data-spillover.svg" class="img-fluid rounded z-depth-1" width="auto" height="auto" style="padding: 20px;" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="caption">Figure 4: Different programming language's knowledge composition in each primary's language data due to the natural occurrence of data spillover.</figcaption>

</figure>

</div>

<ul>
  <li>In Figure 3, we also observe that multi-lingual models perform especially better than mono-lingual models in out-of-domain languages.</li>
  <li>All these observations are consistent with the explanations in Figure 4 where the knowledge in other programming languages is aggregated across all knowledge in each languageâ€™s training data.</li>
</ul>

<h2 id="large-multi-lingual-models-really-shine">Large Multi-Lingual Models Really Shine</h2>
<ul>
  <li>As observed in Figure 3, one can see that if the model size is large enough, the advantages of multi-lingual training is more drastic.</li>
  <li>On out-of-domain evaluation, large multi-lingual models seem to break out of the log-linear trend, akin to being at a cusp of the sigmoid trend going upward, aka <strong>emergent abilities</strong>.</li>
</ul>

<h2 id="zero-shot-translation">Zero-Shot Translation</h2>
<ul>
  <li>We find that language models can also translate code, without being specifically trained to do so.</li>
  <li>This ability extends to a mono-lingual model. For instance, a Java model can translate from Python to Java reasonably well.</li>
  <li>Java to Python is harder for translation with a Java model, since it doesnâ€™t know how to write Python well. However, it understands Python as some level and is able to use it to write a more accurate function.</li>
  <li>In fact, problems that are difficult can become much easier.</li>
</ul>

<div class="col-sm mt-3 mt-md-0">
<figure style="background-color: white;">

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/blogs/assets/img/blogs/mbxp/translation-prompt-example.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" style="padding: 0px;" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="caption">Figure 4: Example of function completion with and without translation.</figcaption>

</figure>

</div>

<div class="row mt-3">
<div class="col-sm mt-3 mt-md-0">
<figure style="background-color: white;">

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/blogs/assets/img/blogs/mbxp/translation-from-python.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" style="padding: 0px;" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="caption">(a) Evaluation results on translation, illustrating that with access to reference solutions, the model can generate more correct functions compared to baseline without translations (indicated by dots)</figcaption>

</figure>

</div>
<div class="col-sm mt-3 mt-md-0">
<figure style="background-color: white;">

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/blogs/assets/img/blogs/mbxp/translation-error-analysis.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" style="padding: 0px;" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="caption">(b) Tasks that are previously difficult (low solve rate for the baseline) can become easily solvable with translation.
For each task within MBXP (MBKP in this case), we show a fraction of generations that pass the tests over the total number of samples (solve rate), where the task indices are ranked to show increasing difficulty. 
The translation solve rate can be perfect (solve rate 1) for some tasks that originally have 0 solve rate.</figcaption>

</figure>

</div>
</div>

<h2 id="few-shot-prompts-helps-llms-on-out-of-domain-languages">Few-Shot Prompts Helps LLMs on Out-of-Domain Languages</h2>

<ul>
  <li>On out-of-domain languages, the performance can be improved significantly if we give the model few-shot prompts.</li>
</ul>

<div class="col-sm mt-3 mt-md-0">
<figure style="background-color: white;">

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/blogs/assets/img/blogs/mbxp/fewshot.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" style="padding: 0px;" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="caption">(a) Few-shot prompting: Improvement on out-of-domain evaluation due to few-shot prompting, where the examples help guide the model to generate more correct code in the given language. 
(b) Few-shot prompts results in lower non-assertion (compile, parsing, syntax) errors on out-of-domain (ood) evaluation but has little effect on in-domain (id), consistent with the results in (a). </figcaption>

</figure>

</div>

<!--
### More Code Generation Abilities
Feel free to check out the paper on evaluation such as code-insertion, robustness, or code summarization.
-->

<h2 id="evaluation-datasets">Evaluation Datasets</h2>

<p>All of the above analyses require evaluation datasets in different programming languages. In our work <a href="https://arxiv.org/pdf/2210.14868.pdf" rel="external nofollow noopener" target="_blank">Multilingual Evaluation of Code Generation Models</a>, we outlined how we obtain such datasets via transpiling the original HumanEval and MBPP into <code class="language-plaintext highlighter-rouge">HumanEvalX</code> and <code class="language-plaintext highlighter-rouge">MBXP</code>. We also compose such datasets for different types of evaluation such as Code Insertion evaluation or Code Robustness evaluation.</p>

<div class="col-sm mt-3 mt-md-0">
<figure style="background-color: white;">

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/blogs/assets/img/blogs/mbxp_methodology.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" style="padding: 0px;" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="caption">Figure : Evaluation Data Synthesis in 10+ Programming Languages.</figcaption>

</figure>

</div>

<div class="col-sm mt-3 mt-md-0">
<figure style="background-color: white;">

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/blogs/assets/img/blogs/mbxp_conversion_bold.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" style="padding: 0px;" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture><figcaption class="caption">Figure : Example of Dataset Language Conversion from Python to Java.</figcaption>

</figure>

</div>

<h2 id="appendix">Appendix</h2>

<h3 id="codex-performance">Codex Performance</h3>
<p>It is unclear what data and how much the Codex models are trained on. However, a viable guess would be that theyâ€™re trained on as much code data as possible with sufficient amount of steps until the performance plateaus.</p>

<p>Below, we show the result of <code class="language-plaintext highlighter-rouge">code-cushman-001</code> and <code class="language-plaintext highlighter-rouge">code-davinci-002</code> for reference. We can observe that the model performs quite well in all languages.</p>

<p>For the evaluation code, see (link to repo).</p>

<p><br></p>

<p><strong>Table 1</strong>: Codex Performance on MBXP and HumanEvalX with pass@1 and greedy decoding.</p>

<table>
  <thead>
    <tr>
      <th>Â </th>
      <th style="text-align: center"><strong>code-cushman-001</strong></th>
      <th style="text-align: center"><strong>code-davinci-002</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>MBXP</strong></td>
      <td style="text-align: center">Â </td>
      <td style="text-align: center">Â </td>
    </tr>
    <tr>
      <td>Python</td>
      <td style="text-align: center"><center>43.7%</center></td>
      <td style="text-align: center">58.7%</td>
    </tr>
    <tr>
      <td>Java</td>
      <td style="text-align: center">45.1%</td>
      <td style="text-align: center"><center>61.0%</center></td>
    </tr>
    <tr>
      <td>JavaScript</td>
      <td style="text-align: center">46.4%</td>
      <td style="text-align: center"><center>62.3%</center></td>
    </tr>
    <tr>
      <td>TypeScript</td>
      <td style="text-align: center">46.0%</td>
      <td style="text-align: center">58.9%</td>
    </tr>
    <tr>
      <td>C#</td>
      <td style="text-align: center">46.2%</td>
      <td style="text-align: center">57.6%</td>
    </tr>
    <tr>
      <td>C++</td>
      <td style="text-align: center">49.3%</td>
      <td style="text-align: center">65.7%</td>
    </tr>
    <tr>
      <td>Go</td>
      <td style="text-align: center">32.7%</td>
      <td style="text-align: center">49.2%</td>
    </tr>
    <tr>
      <td>Kotlin</td>
      <td style="text-align: center">44.6%</td>
      <td style="text-align: center">60.5%</td>
    </tr>
    <tr>
      <td>PHP</td>
      <td style="text-align: center">44.4%</td>
      <td style="text-align: center">60.7%</td>
    </tr>
    <tr>
      <td>Perl</td>
      <td style="text-align: center">34.1%</td>
      <td style="text-align: center">44.0%</td>
    </tr>
    <tr>
      <td>Ruby</td>
      <td style="text-align: center">43.7%</td>
      <td style="text-align: center">56.3%</td>
    </tr>
    <tr>
      <td>Scala</td>
      <td style="text-align: center">41.9%</td>
      <td style="text-align: center">59.8%</td>
    </tr>
    <tr>
      <td>Swift</td>
      <td style="text-align: center">31.3%</td>
      <td style="text-align: center">43.5%</td>
    </tr>
    <tr>
      <td><strong>HumanEvalX</strong></td>
      <td style="text-align: center">Â </td>
      <td style="text-align: center">Â </td>
    </tr>
    <tr>
      <td>Python</td>
      <td style="text-align: center"><center>32.3%</center></td>
      <td style="text-align: center">46.3%</td>
    </tr>
    <tr>
      <td>Java</td>
      <td style="text-align: center">32.9%</td>
      <td style="text-align: center"><center>49.1%</center></td>
    </tr>
    <tr>
      <td>JavaScript</td>
      <td style="text-align: center">28.0%</td>
      <td style="text-align: center"><center>51.6%</center></td>
    </tr>
    <tr>
      <td>Typescript</td>
      <td style="text-align: center">34.8%</td>
      <td style="text-align: center">50.9%</td>
    </tr>
    <tr>
      <td>C#</td>
      <td style="text-align: center">34.8%</td>
      <td style="text-align: center">45.3%</td>
    </tr>
    <tr>
      <td>C++</td>
      <td style="text-align: center">Â </td>
      <td style="text-align: center">Â </td>
    </tr>
    <tr>
      <td>Go</td>
      <td style="text-align: center">16.3%</td>
      <td style="text-align: center">21.9%</td>
    </tr>
    <tr>
      <td>Kotlin</td>
      <td style="text-align: center">23.0%</td>
      <td style="text-align: center">39.8%</td>
    </tr>
    <tr>
      <td>PHP</td>
      <td style="text-align: center">31.1%</td>
      <td style="text-align: center">52.8%</td>
    </tr>
    <tr>
      <td>Perl</td>
      <td style="text-align: center">14.9%</td>
      <td style="text-align: center">36.0%</td>
    </tr>
    <tr>
      <td>Ruby</td>
      <td style="text-align: center">29.8%</td>
      <td style="text-align: center">39.8%</td>
    </tr>
    <tr>
      <td>Scala</td>
      <td style="text-align: center">24.2%</td>
      <td style="text-align: center">45.3%</td>
    </tr>
    <tr>
      <td>Swift</td>
      <td style="text-align: center">14.9%</td>
      <td style="text-align: center">24.8%</td>
    </tr>
  </tbody>
</table>

<!-- .......................................................................... -->
<!-- .......................................................................... -->
<!-- .......................................................................... -->
<!-- .......................................................................... -->
<!-- .......................................................................... -->
<!-- .......................................................................... -->
<!-- .......................................................................... -->
<!-- .......................................................................... -->
<!-- .......................................................................... -->

<!--
<d-code  language="python">
</d-code>

Why does highlight work for post but not for distill?
-->

<!--

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="n">org.jython.book.interfaces</span> <span class="kn">import</span> <span class="n">BuildingType</span>

<span class="k">class</span> <span class="nc">Building</span><span class="p">(</span><span class="n">BuildingType</span><span class="p">):</span>
   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
      <span class="n">self</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
      <span class="n">self</span><span class="p">.</span><span class="n">address</span>  <span class="o">=</span>  <span class="n">address</span>
      <span class="n">self</span><span class="p">.</span><span class="nb">id</span> <span class="o">=</span> <span class="nb">id</span>

   <span class="k">def</span> <span class="nf">getBuildingName</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">name</span>

   <span class="k">def</span> <span class="nf">getBuildingAddress</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">address</span>

   <span class="k">def</span> <span class="nf">getBuldingId</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nb">id</span>

<span class="n">package</span> <span class="n">org</span><span class="p">.</span><span class="n">jython</span><span class="p">.</span><span class="n">book</span><span class="p">.</span><span class="n">interfaces</span><span class="p">;</span>

<span class="n">public</span> <span class="n">interface</span> <span class="n">BuildingType</span> <span class="p">{</span>

    <span class="n">public</span> <span class="n">String</span> <span class="nf">getBuildingName</span><span class="p">();</span>
    <span class="n">public</span> <span class="n">String</span> <span class="nf">getBuildingAddress</span><span class="p">();</span>
    <span class="n">public</span> <span class="n">String</span> <span class="nf">getBuildingId</span><span class="p">();</span>

<span class="p">}</span>

<span class="n">package</span> <span class="n">org</span><span class="p">.</span><span class="n">jython</span><span class="p">.</span><span class="n">book</span><span class="p">.</span><span class="n">util</span><span class="p">;</span>

<span class="kn">import</span> <span class="n">org.jython.book.interfaces.BuildingType</span><span class="p">;</span>
<span class="kn">import</span> <span class="n">org.python.core.PyObject</span><span class="p">;</span>
<span class="kn">import</span> <span class="n">org.python.core.PyString</span><span class="p">;</span>
<span class="kn">import</span> <span class="n">org.python.util.PythonInterpreter</span><span class="p">;</span>

<span class="n">public</span> <span class="k">class</span> <span class="nc">BuildingFactory</span> <span class="p">{</span>

    <span class="n">private</span> <span class="n">PyObject</span> <span class="n">buildingClass</span><span class="p">;</span>

    <span class="n">public</span> <span class="nc">BuildingFactory</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">PythonInterpreter</span> <span class="n">interpreter</span> <span class="o">=</span> <span class="n">new</span> <span class="nc">PythonInterpreter</span><span class="p">();</span>
        <span class="n">interpreter</span><span class="p">.</span><span class="nf">exec</span><span class="p">(</span><span class="sh">"</span><span class="s">from Building import Building</span><span class="sh">"</span><span class="p">);</span>
        <span class="n">buildingClass</span> <span class="o">=</span> <span class="n">interpreter</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">Building</span><span class="sh">"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">public</span> <span class="n">BuildingType</span> <span class="nf">create</span><span class="p">(</span><span class="n">String</span> <span class="n">name</span><span class="p">,</span> <span class="n">String</span> <span class="n">location</span><span class="p">,</span> <span class="n">String</span> <span class="nb">id</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">PyObject</span> <span class="n">buildingObject</span> <span class="o">=</span> <span class="n">buildingClass</span><span class="p">.</span><span class="nf">__call__</span><span class="p">(</span><span class="n">new</span> <span class="nc">PyString</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
<span class="n">new</span> <span class="nc">PyString</span><span class="p">(</span><span class="n">location</span><span class="p">),</span>
<span class="n">new</span> <span class="nc">PyString</span><span class="p">(</span><span class="nb">id</span><span class="p">));</span>
        <span class="nf">return </span><span class="p">(</span><span class="n">BuildingType</span><span class="p">)</span><span class="n">buildingObject</span><span class="p">.</span><span class="nf">__tojava__</span><span class="p">(</span><span class="n">BuildingType</span><span class="p">.</span><span class="n">class</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span></code></pre></figure>

-->

<h3 id="unabridged-example-of-knowledge-spillover">Unabridged Example of Knowledge Spillover</h3>
<p>Below we show a full code snippet of a Python file where JS code is wrapped in a string.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="sh">"""</span><span class="s">Create a Javascript script to encode / decode for a specific encoding
described in a file available at
http://unicode.org/Public/MAPPINGS/VENDORS/MICSFT/WINDOWS/&lt;ENCODING&gt;.TXT
</span><span class="sh">"""</span>

<span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">re</span>
<span class="kn">import</span> <span class="n">json</span>
<span class="kn">import</span> <span class="n">urllib.request</span>

<span class="n">line_re</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nf">compile</span><span class="p">(</span><span class="sh">"</span><span class="s">^(0x[A-Z0-9]+)\s+(0x[A-Z0-9]+)*</span><span class="sh">"</span><span class="p">,</span> <span class="n">re</span><span class="p">.</span><span class="n">M</span><span class="p">)</span>

<span class="n">tmpl</span> <span class="o">=</span> <span class="sh">"</span><span class="s">http://unicode.org/Public/MAPPINGS/VENDORS/MICSFT/WINDOWS/{}.TXT</span><span class="sh">"</span>
<span class="n">encoding</span> <span class="o">=</span> <span class="nf">input</span><span class="p">(</span><span class="sh">"</span><span class="s">Encoding name: </span><span class="sh">"</span><span class="p">)</span>
<span class="n">req</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="nf">urlopen</span><span class="p">(</span><span class="n">tmpl</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">encoding</span><span class="p">.</span><span class="nf">upper</span><span class="p">()))</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">req</span><span class="p">.</span><span class="nf">read</span><span class="p">().</span><span class="nf">decode</span><span class="p">(</span><span class="sh">"</span><span class="s">ascii</span><span class="sh">"</span><span class="p">)</span>

<span class="n">root_dir</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">dirname</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">))</span>
<span class="n">libs_dir</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">root_dir</span><span class="p">,</span> <span class="sh">"</span><span class="s">www</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">src</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">libs</span><span class="sh">"</span><span class="p">)</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">libs_dir</span><span class="p">,</span> <span class="sa">f</span><span class="sh">"</span><span class="s">encoding_</span><span class="si">{</span><span class="n">encoding</span><span class="p">.</span><span class="nf">lower</span><span class="p">()</span><span class="si">}</span><span class="s">.js</span><span class="sh">"</span><span class="p">)</span>
<span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="sh">"</span><span class="s">w</span><span class="sh">"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="sh">"</span><span class="s">utf-8</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">out</span><span class="p">:</span>
    <span class="n">out</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">"</span><span class="s">var _table = [</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="sh">"</span><span class="p">):</span>
        <span class="n">mo</span> <span class="o">=</span> <span class="n">line_re</span><span class="p">.</span><span class="nf">match</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mo</span><span class="p">:</span>
            <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">mo</span><span class="p">.</span><span class="nf">groups</span><span class="p">()</span>
            <span class="n">out</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">value</span> <span class="ow">or</span> <span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s">,</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">out</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">"</span><span class="s">]</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">out</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">"</span><span class="s">var decoding_table = [],</span><span class="se">\n</span><span class="s">    encoding_table = []</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">out</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">"""</span><span class="s">for(var i = 0, len = _table.length; i &lt; len; i += 2){
var value = _table[i + 1]
if(value !== null){
    encoding_table[value] = _table[i]
}
decoding_table[_table[i]] = _table[i + 1]
}
$module = {encoding_table, decoding_table}
</span><span class="sh">"""</span><span class="p">)</span></code></pre></figure>


      </d-article>

      <d-appendix>
        <d-footnote-list></d-footnote-list>
        <d-citation-list></d-citation-list>
      </d-appendix>

      <d-bibliography src="/blogs/assets/bibliography/2018-12-22-distill.bib"></d-bibliography><div id="giscus_thread" style="max-width: 800px; margin: 0 auto;">
  <script>
    let giscusTheme = localStorage.getItem("theme");
    let giscusAttributes = {
        "src": "https://giscus.app/client.js",
        "data-repo": "benathi/blogs",
        "data-repo-id": "R_kgDOI_5r3w",
        "data-category": "Ideas",
        "data-category-id": "DIC_kwDOI_5r384CUfWs",
        "data-mapping": "pathname",
        "data-strict": "0",
        "data-reactions-enabled": "1",
        "data-emit-metadata": "0",
        "data-input-position": "top",
        "data-theme": giscusTheme,
        "data-lang": "en",
        "crossorigin": "anonymous",
        "async": "",
    };

    let giscusScript = document.createElement("script");
    Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
    document.getElementById("giscus_thread").appendChild(giscusScript);
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a>
</noscript>
</div>
</div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        Â© Copyright 2023 Ben  Athiwaratkun. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>.

      </div>
    </footer>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-L4T90Z05NK"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ window.dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-L4T90Z05NK');
  </script>
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": navbarHeight });
    $("progress-container").css({ "padding-top": navbarHeight });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>

  
</body>
</html>
